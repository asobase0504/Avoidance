//=============================================================================
//
// プレイヤー設定
// Author:Yuda Kaito
//
//=============================================================================
#include <assert.h>
#include "plain.h"
#include "utility.h"

#include "application.h"
#include "task_group.h"
#include "camera.h"
#include "color.h"
#include "line.h"

//-----------------------------------------------------------------------------
// コンストラクタ
//-----------------------------------------------------------------------------
CPlain::CPlain()
{
}

//-----------------------------------------------------------------------------
// デストラクタ
//-----------------------------------------------------------------------------
CPlain::~CPlain()
{
}

//-----------------------------------------------------------------------------
// 初期化
//-----------------------------------------------------------------------------
HRESULT CPlain::Init()
{
	begin = false;
	m_display = true;
	m_isDisplayOperation = false;
	m_endCnt = 0;
	// 現在のモーション番号の保管
	CObjectX::Init();
	LoadModel("BOX");
	SetType(EType::PLAIN);

	AttachOutLine();

	return S_OK;
}

//-----------------------------------------------------------------------------
// 終了
//-----------------------------------------------------------------------------
void CPlain::Uninit()
{
	CObjectX::Uninit();
}

//-----------------------------------------------------------------------------
// 更新
//-----------------------------------------------------------------------------
void CPlain::NormalUpdate()
{
}

//-----------------------------------------------------------------------------
// 更新
//-----------------------------------------------------------------------------
void CPlain::EndUpdate()
{
	if(!begin)
	{
		SetMove(D3DXVECTOR3(FloatRandom(5.0f, -5.0f), 0.0f, FloatRandom(5.0f, -5.0f)));
		SetMoveRot(D3DXVECTOR3(FloatRandom(0.015f, -0.015f), 0.0f, FloatRandom(0.0125f, -0.015f)));
		begin = true;
		SetCollisionFlag(false);
	}

	m_endCnt++;

	if (m_endCnt > 750)
	{
		Release();
	}
}

//-----------------------------------------------------------------------------
// 描画
//-----------------------------------------------------------------------------
void CPlain::Draw()
{
	if (!m_isDisplayOperation || m_display)
	{
		CObjectX::Draw();
	}
}

//-----------------------------------------------------------------------------
// 生成
//-----------------------------------------------------------------------------
CPlain* CPlain::Create()
{
	CPlain* plain = new CPlain;

	if (plain != nullptr)
	{
		plain->Init();
	}

	return plain;
}

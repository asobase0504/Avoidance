//=============================================================================
//
// プレイヤー設定
// Author:Yuda Kaito
//
//=============================================================================
#include <assert.h>
#include "goal.h"
#include "delay_process.h"

//-----------------------------------------------------------------------------
// コンストラクタ
//-----------------------------------------------------------------------------
CGoal::CGoal() :
	m_endCnt(0),
	m_isGoal(false)
{
}

//-----------------------------------------------------------------------------
// デストラクタ
//-----------------------------------------------------------------------------
CGoal::~CGoal()
{
}

//-----------------------------------------------------------------------------
// 初期化
//-----------------------------------------------------------------------------
HRESULT CGoal::Init()
{
	// 現在のモーション番号の保管
	CObjectX::Init();
	LoadModel("BOX");
	SetType(EType::GOAL);
	SetCollisionFlag(false);
	return S_OK;
}

//-----------------------------------------------------------------------------
// 終了
//-----------------------------------------------------------------------------
void CGoal::Uninit()
{
	CObjectX::Uninit();
}

//-----------------------------------------------------------------------------
// 更新
//-----------------------------------------------------------------------------
void CGoal::NormalUpdate()
{
}

//-----------------------------------------------------------------------------
// 更新
//-----------------------------------------------------------------------------
void CGoal::EndUpdate()
{
	m_endCnt++;

	if (m_endCnt > 180)
	{
		Release();
	}
}

//-----------------------------------------------------------------------------
// 描画
//-----------------------------------------------------------------------------
void CGoal::Draw()
{
	CObjectX::Draw();
}

//-----------------------------------------------------------------------------
// 生成
//-----------------------------------------------------------------------------
CGoal* CGoal::Create()
{
	CGoal* goal = new CGoal;

	if (goal != nullptr)
	{
		goal->Init();
	}

	return goal;
}

void CGoal::SetTime(int inTime)
{
	m_goalTime = inTime;

	CDelayProcess::DelayProcess(inTime, this, [this]()
	{
		SetMaterialDiffuse(0,D3DXCOLOR(1.0f,1.0f,0.0f,1.0f));
		SetCollisionFlag(true);
	});
}
